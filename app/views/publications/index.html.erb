<%
   @title = :publication_index_title.l
   new_tab_set do
     add_tab(:create_publication.t, new_publication_path)
   end
%>

<div class="row">
  <div class="col-xs-12 max-width-text">
    <%= :publication_index_intro.tp %>
    <%= :publication_citation.tp %>
    <%= link_to 'Wood, Michael (Summer 2008). "WebWatch: Observing Mushrooms". Fungi Magazine 1 (2).', "http://www.mykoweb.com/articles/Web%20Watch--Mushroom%20Observer.pdf" %>
  </div>
</div>

<div class="row">
  <div class="col-xs-12">
    <table class="table-striped table-publications push-up push-down">

      <thead>
        <tr>
          <th>
            <%= :publication_full.t %> (<%= @full_count %>)
          </th>
          <th>
            <%= :publication_link.t %>
          </th>
          <th>
            (<%= @peer_count %>)
          </th>
          <th>
            (<%= @mo_count %>)
          </th>
          <% if is_in_admin_mode? || publication.can_edit?(@user) %>
            <th></th>
            <th></th>
          <% end %>
        </tr>
      </thead>

      <tbody>
        <% for publication in @publications %>
          <tr>
            <td>
              <%= link_to(publication.full.t.strip_links.html_safe, publication) %>
            </td>
            <td>
              <%= str = publication.link.sub(/^(.*:\/\/)?(web\.|www\.)?/, "").truncate(30)
              link_to(str, publication.link, title: publication.link, data: {toggle: "tooltip"}) %>
            </td>
            <td>
              <%= "P" if publication.peer_reviewed %>
            </td>
            <td>
              <%= "M" if publication.mo_mentioned %>
            </td>
            <% if is_in_admin_mode? || publication.can_edit?(@user) %>
              <td>
                <%= link_to(:EDIT.t, edit_publication_path(publication)) %>
              </td>
              <td>
                <%= link_to(:DESTROY.t, {action: :destroy, id: publication.id},
                            {data: {confirm: :are_you_sure.t}}) %>
              </td>
            <% end %>
          </tr>
        <% end %>
      </tbody>

    </table>
  </div>
</div>

<div class="row">
  <div class="col-xs-12 max-width-text">
    <%= :publication_legend.tp %>
  </div>
</div>
