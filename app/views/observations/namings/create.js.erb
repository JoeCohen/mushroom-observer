// What to do on ajax create

var observation_namings = $("#observation_namings");
$("#namings_table").remove();
var title_str = "<%= show_obs_title(obs: @observation) %>";

// Are we on show_obs, or obs_needing_ids?
if (observation_namings.length) {
  // alert("Wowie");
  // reset title of obs if necessary
  var title = '<%= content_tag(:div, show_obs_title(obs: @observation), title: show_obs_title(obs: @observation).strip_html.html_safe) %>';

  document.title = $(title).attr('title');
  $("#title").html(title);

  observation_namings.prepend('<%= j render(partial: "observations/namings/table", locals: { observation: @observation.reload }, layout: false) %>');
  // Need to redo bindings for entire table and hide cast vote buttons
  VoteByAjaxModule({
    show_namings_lose_changes: '<%= j :show_namings_lose_changes.l.gsub("\n", " ") %>',
    show_namings_saving: '<%= j :show_namings_saving.l %>'
  })
} else {
  // update the caption title in the lightbox
  var caption_what = $("#observation_what_<%= j @observation.id %>");
  caption_what.html(title_str);
  // update the matrix box title in the page
  var matrix_what = $("#box_<%= j @observation.id %>").find(".rss-what h5");
  matrix_what.html("<%= @observation.unique_format_name.t %>");
  // it would be nice to put something in the modal
}

// Finally, remove the modal
$("#modal_propose_naming").modal('hide');
