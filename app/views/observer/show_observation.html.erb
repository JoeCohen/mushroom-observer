<%
  @title = :show_observation_title.t(:name => @observation.unique_format_name)

  questions_ok = @observation.user.email_general_question
  name = @observation.name
  user_has_lists = @user && !@user.species_lists.empty?
  javascript_include("vote_popup")

  tabs = []
  if name && !name.unknown?
    tabs << link_to(:google_images.t, 'http://images.google.com/images?q=%s' % name.real_text_name)
    tabs << link_with_query(:show_name_distribution_map.t, {controller: 'name',
                            action: 'map', id: name.id})
  end
  if questions_ok && @user != @observation.user
    tabs << link_with_query(:show_observation_send_question.t,
                            :controller => 'observer', :action => 'ask_observation_question',
                            :id => @observation.id)
  end
  if @user && @user.has_unshown_naming_notifications?(@observation)
    tabs << link_with_query(:show_observation_view_notifications.t,
                            controller: 'observation', action: 'show_notifications', id: @observation.id)
  end
  if user_has_lists
    tabs << link_with_query(:show_observation_manage_species_lists.t,
                            {controller: 'species_list', action: 'manage_species_lists',
                            id: @observation.id})
  end
  if @mappable
    tabs << link_with_query(:MAP.t, controller: 'location', action: 'map_locations')
  end
  if check_permission(@observation)
    tabs << link_with_query(:show_observation_edit_observation.t,
                            {controller: 'observer', action: 'edit_observation', id: @observation.id})
    tabs << link_with_query(:DESTROY.t, {controller: 'observer', action: 'destroy_observation', id: @observation.id},
                            {class: "text-danger", data: {confirm: :are_you_sure.l}})
  end
  tabs << draw_interest_icons(@observation)
  @tabsets = {
    pager_for: @observation,
    right: draw_tab_set(tabs)
  }
%>

<div class="row">
  <div class="col-sm-8">
    <div class="list-group">
      <div class="list-group-item">
        <%= render(partial: 'show_observation', locals: {observation: @observation}) %>
      </div>
    </div>
    <%= render(partial: 'show_image_slider', locals: {thumb_size_control: true}) %>
  </div>
  <div class="col-sm-4">
    <div class="list-group">
      <div class="list-group-item">
        <%= render(partial: 'show_name_info', locals: {observation: @observation}) %>
      </div>
    </div>
    <%= render(partial: 'show_thumbnail_map', locals: {observation: @observation}) unless browser.bot? %>
    <%= render(partial: 'show_lists', locals: {observation: @observation}) %>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    <%= render(partial: 'naming/show', locals: {observation: @observation}) %>
    <%= render(partial: 'comment/show_comments', locals: {object: @observation,
                                                          controls: true, limit: nil}) %>
  </div>
</div>
<%= show_object_footer(@observation) %>


